#!/usr/bin/sh

# First: chmod +x setup.sh
# Then: sudo ./setup.sh

echo "[*] Make sure you are running this as root and press enter if so..."
read a
echo "[*] Compiling filecheck.c..."
gcc filecheck.c -o filecheck
echo "[*] Changing own of 'filecheck' to root..."
sudo chown root:root ./filecheck
sudo chmod u+s ./filecheck
echo "[*] Creating test flag file 'flag.txt'..."
echo "CTFA{this_is_a_test_flag}">flag.txt
echo "[*] Changing own of 'flag.txt' to root..."
sudo chown root:root ./flag.txt
echo "[*] Giving execution permissions to 'filecheck'..."
sudo chmod +x ./filecheck
echo "[*] Making 'flag.txt' non-readable except from root..."
sudo chmod -r ./flag.txt
echo "[+] All done. Now make an exploit to read flag.txt when just root can do."
exit
